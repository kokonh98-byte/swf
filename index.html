<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flash Game</title>
    <style>
        /* RESET - –º–Ω–æ–≥–æ –≤–∞–∂–µ–Ω */
        * {
            margin: 0;
            padding: 0;
            border: 0;
            box-sizing: border-box;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: #000;
        }
        
        #container {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        ruffle-player {
            width: 100% !important;
            height: 100% !important;
            display: block !important;
        }
        
        /* –ë—É—Ç–æ–Ω –∑–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ü–∏—è (–∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–æ –∑–∞ –∑–≤—É–∫–∞) */
        #startBtn {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 30px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            cursor: pointer;
            z-index: 1000;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }
        
        #startBtn:hover {
            background: #45a049;
        }
    </style>
    
    <script>
        window.RufflePlayer = window.RufflePlayer || {};
        window.RufflePlayer.config = {
            publicPath: "",
            autoplay: "on",
            unmuteOverlay: "hidden",
            backgroundColor: "#000000",
            letterbox: "on",
            warnOnUnsupportedContent: false,
            logLevel: "warn",
            // –ü—Ä–æ–±–≤–∞–π—Ç–µ —Ä–∞–∑–ª–∏—á–Ω–∏ —Ä–∞–∑–º–µ—Ä–∏
            defaultWidth: 800,
            defaultHeight: 600,
            scale: "showAll",
            // –ó–≤—É–∫–æ–≤–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            autoplay: "user",
            preloader: true
        };
    </script>
</head>
<body>
    <!-- –ë—É—Ç–æ–Ω –∑–∞ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ (–∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–µ–Ω –∑–∞ –∑–≤—É–∫–∞) -->
    <button id="startBtn">üéÆ –ö–ª–∏–∫–Ω–∏ —Ç—É–∫ –∑–∞ –¥–∞ —Å—Ç–∞—Ä—Ç–∏—Ä–∞—à –∏–≥—Ä–∞—Ç–∞</button>
    
    <div id="container"></div>
    
    <script src="ruffle.js"></script>
    
    <script>
        let rufflePlayer = null;
        let isInitialized = false;
        
        // –§—É–Ω–∫—Ü–∏—è –∑–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –∏–≥—Ä–∞—Ç–∞
        function initGame() {
            if (isInitialized) return;
            
            try {
                console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –∏–≥—Ä–∞—Ç–∞...');
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–ª–∏ Ruffle –µ –≥–æ—Ç–æ–≤
                if (!window.RufflePlayer || !window.RufflePlayer.newest) {
                    console.log('Ruffle –≤—Å–µ –æ—â–µ –Ω–µ –µ –≥–æ—Ç–æ–≤, –æ–ø–∏—Ç–≤–∞–º –æ—Ç–Ω–æ–≤–æ...');
                    setTimeout(initGame, 100);
                    return;
                }
                
                const ruffle = window.RufflePlayer.newest();
                const container = document.getElementById('container');
                
                // –ò–∑—á–∏—Å—Ç–≤–∞–Ω–µ –Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
                container.innerHTML = '';
                
                // –°—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ –ø–ª–µ—ä—Ä
                rufflePlayer = ruffle.createPlayer();
                
                // –ó–∞–¥–∞–≤–∞–Ω–µ –Ω–∞ –∞—Ç—Ä–∏–±—É—Ç–∏
                rufflePlayer.setAttribute('width', '100%');
                rufflePlayer.setAttribute('height', '100%');
                
                // –î–æ–±–∞–≤—è–Ω–µ –∫—ä–º DOM
                container.appendChild(rufflePlayer);
                
                // –ó–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ SWF —Ñ–∞–π–ª–∞
                console.log('–ó–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ game.swf...');
                
                // –ü—Ä–æ–±–≤–∞–π—Ç–µ —Ä–∞–∑–ª–∏—á–Ω–∏ –æ–ø—Ü–∏–∏
                const loadOptions = {
                    url: 'game.swf',
                    width: 800,    // –ü—Ä–æ–±–≤–∞–π—Ç–µ —Ä–∞–∑–ª–∏—á–Ω–∏ —Ä–∞–∑–º–µ—Ä–∏
                    height: 600,
                    backgroundColor: '#000000',
                    allowScriptAccess: true
                };
                
                rufflePlayer.load(loadOptions)
                    .then(() => {
                        console.log('‚úÖ –ò–≥—Ä–∞—Ç–∞ –µ –∑–∞—Ä–µ–¥–µ–Ω–∞!');
                        isInitialized = true;
                        
                        // –°–∫—Ä–∏–≤–∞–Ω–µ –Ω–∞ –±—É—Ç–æ–Ω–∞ —Å–ª–µ–¥ —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ
                        document.getElementById('startBtn').style.display = 'none';
                        
                        // –§–æ–∫—É—Å –≤—ä—Ä—Ö—É –∏–≥—Ä–∞—Ç–∞
                        rufflePlayer.focus();
                        
                        // –†—ä—á–Ω–æ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –∞—É–¥–∏–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (–º–Ω–æ–≥–æ –≤–∞–∂–Ω–æ!)
                        resumeAudioContext();
                        
                        // –ê–∫–æ –≤—Å–µ –æ—â–µ –Ω–µ —Å–µ –≤–∏–∂–¥–∞, –æ–ø–∏—Ç–∞–π—Ç–µ –¥–∞ –∑–∞–¥–∞–¥–µ—Ç–µ —Ä–∞–∑–º–µ—Ä
                        setTimeout(() => {
                            if (rufflePlayer) {
                                // –ü—Ä–æ–±–≤–∞–π—Ç–µ –¥–∞ –∑–∞–¥–∞–¥–µ—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–µ–Ω —Ä–∞–∑–º–µ—Ä
                                rufflePlayer.style.width = '800px';
                                rufflePlayer.style.height = '600px';
                                rufflePlayer.style.margin = 'auto';
                                rufflePlayer.style.display = 'block';
                                
                                // –ü—Ä–æ–±–≤–∞–π—Ç–µ –¥–∞ —Ü–µ–Ω—Ç—Ä–∏—Ä–∞—Ç–µ
                                container.style.display = 'flex';
                                container.style.justifyContent = 'center';
                                container.style.alignItems = 'center';
                            }
                        }, 500);
                    })
                    .catch(error => {
                        console.error('‚ùå –ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ:', error);
                        showError(error.message);
                    });
                    
            } catch (error) {
                console.error('–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:', error);
                showError(error.message);
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –∑–∞ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –∞—É–¥–∏–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (–ú–ù–û–ì–û –í–ê–ñ–ù–ê)
        function resumeAudioContext() {
            try {
                // –¢–æ–≤–∞ –µ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–æ –∑–∞ –¥–∞ —Ä–∞–±–æ—Ç–∏ –∑–≤—É–∫–∞
                if (window.RufflePlayer && window.RufflePlayer.audioContext) {
                    if (window.RufflePlayer.audioContext.state === 'suspended') {
                        window.RufflePlayer.audioContext.resume();
                        console.log('–ê—É–¥–∏–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ä—Ç –µ –∞–∫—Ç–∏–≤–∏—Ä–∞–Ω');
                    }
                }
            } catch (e) {
                console.warn('–ù–µ—É—Å–ø–µ—à–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–∞–Ω–µ –Ω–∞ –∞—É–¥–∏–æ:', e);
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –∑–∞ –ø–æ–∫–∞–∑–≤–∞–Ω–µ –Ω–∞ –≥—Ä–µ—à–∫–∞
        function showError(message) {
            const container = document.getElementById('container');
            container.innerHTML = `
                <div style="color: white; text-align: center; padding: 40px; font-family: Arial;">
                    <h2 style="color: #ff5555;">‚ùå –ì—Ä–µ—à–∫–∞</h2>
                    <p style="margin: 20px 0; background: #222; padding: 15px; border-radius: 10px;">
                        ${message}
                    </p>
                    <button onclick="location.reload()" style="padding: 10px 20px; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer;">
                        –û–ø—Ä–µ—Å–Ω–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ç–∞
                    </button>
                </div>
            `;
        }
        
        // –°—ä–±–∏—Ç–∏–µ –ø—Ä–∏ –∫–ª–∏–∫–≤–∞–Ω–µ –Ω–∞ –±—É—Ç–æ–Ω–∞
        document.getElementById('startBtn').addEventListener('click', function() {
            console.log('–°—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –∏–≥—Ä–∞—Ç–∞ —Å–ª–µ–¥ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ...');
            this.style.display = 'none';
            initGame();
        });
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –∞–∫–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è—Ç –Ω—è–∫—ä–ª–∫–Ω–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ç–∞
        document.addEventListener('click', function() {
            if (!isInitialized) {
                initGame();
            }
        });
        
        // –°—ä—â–æ –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–µ –Ω–∞ –∫–ª–∞–≤–∏—à
        document.addEventListener('keydown', function() {
            if (!isInitialized) {
                initGame();
            }
        });
        
        // –î–µ–±—ä–≥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        console.log('Ruffle –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:', window.RufflePlayer.config);
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ —Å–ª–µ–¥ 2 —Å–µ–∫—É–Ω–¥–∏ –∞–∫–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è—Ç –≤–µ—á–µ –µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∞–ª
        setTimeout(() => {
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–ª–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è—Ç –µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∞–ª
            if (document.hasFocus()) {
                initGame();
            }
        }, 2000);
        
    </script>
</body>
</html>
